# Импортируем модуль для работы с SQLite базами данных
import sqlite3

# Открываем файл с афоризмами для чтения
# Используем кодировку utf-8 для корректного отображения русских букв
with open("aphorisms.txt", "r", encoding="utf-8") as f:
    # Читаем весь файл одной строкой
    # Разделяем текст по двойным переносам строки (\n\n) - так разделены афоризмы
    # Убираем пробельные символы с помощью strip() для каждого афоризма
    # if a.strip() отфильтровывает пустые строки
    aphorisms = [a.strip() for a in f.read().split("\n\n") if a.strip()]

# Создаем соединение с базой данных SQLite
# Файл базы данных будет называться 'aphorisms_simple.db'
# Если файла нет, он будет создан автоматически
conn = sqlite3.connect("aphorisms_simple.db")

# Создаем курсор - объект для выполнения SQL-запросов
cursor = conn.cursor()

# Выполняем SQL-запрос для создания таблицы 'aphorisms'
# Таблица содержит два столбца:
# - id: целое число, первичный ключ (автоматически увеличивается)
# - text: текстовое поле для хранения афоризмов
cursor.execute("CREATE TABLE aphorisms (id INTEGER PRIMARY KEY, text TEXT)")

# Проходим по списку афоризмов в цикле
for aph in aphorisms:
    # Для каждого афоризма выполняем SQL-запрос INSERT
    # Вставляем афоризм в таблицу 'aphorisms' в столбец 'text'
    # Знак ? - это параметризованный запрос, который защищает от SQL-инъекций
    # (aph,) - кортеж с одним элементом (запятая важна!)
    cursor.execute("INSERT INTO aphorisms (text) VALUES (?)", (aph,))

# Сохраняем все изменения в базе данных
# Без этого вызова изменения не будут записаны в файл
conn.commit()

# Выводим информацию о результате работы скрипта
print(f"Сохранено {len(aphorisms)} афоризмов")

# Закрываем соединение с базой данных
# Важно делать это для освобождения ресурсов
conn.close()
